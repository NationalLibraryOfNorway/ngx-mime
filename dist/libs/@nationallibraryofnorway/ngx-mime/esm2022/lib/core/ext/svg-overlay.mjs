// OpenSeadragon SVG Overlay plugin 0.0.4
export function createSvgOverlay() {
    if (!OpenSeadragon) {
        console.error('[openseadragon-svg-overlay] requires OpenSeadragon');
        return;
    }
    const svgNS = 'http://www.w3.org/2000/svg';
    // ----------
    class Overlay {
        constructor(viewer) {
            const self = this;
            this._viewer = viewer;
            this._containerWidth = 0;
            this._containerHeight = 0;
            this._svg = document.createElementNS(svgNS, 'svg');
            this._svg.style.position = 'absolute';
            this._svg.style.left = 0;
            this._svg.style.top = 0;
            this._svg.style.width = '100%';
            this._svg.style.height = '100%';
            this._viewer.canvas.appendChild(this._svg);
            this._node = document.createElementNS(svgNS, 'g');
            this._svg.appendChild(this._node);
            this._viewer.addHandler('animation', function () {
                self.resize();
            });
            this._viewer.addHandler('open', function () {
                self.resize();
            });
            this._viewer.addHandler('rotate', function (evt) {
                self.resize();
            });
            this._viewer.addHandler('resize', function () {
                self.resize();
            });
            this.resize();
        }
        node() {
            return this._node;
        }
        // ----------
        resize() {
            if (this._containerWidth !== this._viewer.container.clientWidth) {
                this._containerWidth = this._viewer.container.clientWidth;
                this._svg.setAttribute('width', this._containerWidth);
            }
            if (this._containerHeight !== this._viewer.container.clientHeight) {
                this._containerHeight = this._viewer.container.clientHeight;
                this._svg.setAttribute('height', this._containerHeight);
            }
            const p = this._viewer.viewport.pixelFromPoint(new OpenSeadragon.Point(0, 0), true);
            const zoom = this._viewer.viewport.getZoom(true);
            const rotation = this._viewer.viewport.getRotation();
            // TODO: Expose an accessor for _containerInnerSize in the OSD API so we don't have to use the private variable.
            const scale = this._viewer.viewport._containerInnerSize.x * zoom;
            this._node.setAttribute('transform', 'translate(' +
                p.x +
                ',' +
                p.y +
                ') scale(' +
                scale +
                ') rotate(' +
                rotation +
                ')');
        }
        // ----------
        onClick(node, handler) {
            // TODO: Fast click for mobile browsers
            new OpenSeadragon.MouseTracker({
                element: node,
                clickHandler: handler,
            }).setTracking(true);
        }
    }
    // ----------
    // ----------
    OpenSeadragon.Viewer.prototype.svgOverlay = function () {
        if (this._svgOverlayInfo) {
            return this._svgOverlayInfo;
        }
        this._svgOverlayInfo = new Overlay(this);
        return this._svgOverlayInfo;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3ZnLW92ZXJsYXkuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL25neC1taW1lL3NyYy9saWIvY29yZS9leHQvc3ZnLW92ZXJsYXkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEseUNBQXlDO0FBRXpDLE1BQU0sVUFBVSxnQkFBZ0I7SUFDOUIsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ25CLE9BQU8sQ0FBQyxLQUFLLENBQUMsb0RBQW9ELENBQUMsQ0FBQztRQUNwRSxPQUFPO0lBQ1QsQ0FBQztJQUVELE1BQU0sS0FBSyxHQUFHLDRCQUE0QixDQUFDO0lBRTNDLGFBQWE7SUFDYixNQUFNLE9BQU87UUFTWCxZQUFZLE1BQVc7WUFDckIsTUFBTSxJQUFJLEdBQUcsSUFBSSxDQUFDO1lBRWxCLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO1lBQ3RCLElBQUksQ0FBQyxlQUFlLEdBQUcsQ0FBQyxDQUFDO1lBQ3pCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLENBQUM7WUFFMUIsSUFBSSxDQUFDLElBQUksR0FBRyxRQUFRLENBQUMsZUFBZSxDQUFDLEtBQUssRUFBRSxLQUFLLENBQUMsQ0FBQztZQUNuRCxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFRLEdBQUcsVUFBVSxDQUFDO1lBQ3RDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksR0FBRyxDQUFDLENBQUM7WUFDekIsSUFBSSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsR0FBRyxHQUFHLENBQUMsQ0FBQztZQUN4QixJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxLQUFLLEdBQUcsTUFBTSxDQUFDO1lBQy9CLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUM7WUFDaEMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsV0FBVyxDQUFD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YUFDdEIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUN2QixDQUFDO0tBQ0Y7SUFFRCxhQUFhO0lBRWIsYUFBYTtJQUNiLGFBQWEsQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLFVBQVUsR0FBRztRQUMxQyxJQUFJLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztZQUN6QixPQUFPLElBQUksQ0FBQyxlQUFlLENBQUM7UUFDOUIsQ0FBQztRQUVELElBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDekMsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQzlCLENBQUMsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJkZWNsYXJlIGNvbnN0IE9wZW5TZWFkcmFnb246IGFueTtcblxuLy8gT3BlblNlYWRyYWdvbiBTVkcgT3ZlcmxheSBwbHVnaW4gMC4wLjRcblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVN2Z092ZXJsYXkoKSB7XG4gIGlmICghT3BlblNlYWRyYWdvbikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1tvcGVuc2VhZHJhZ29uLXN2Zy1vdmVybGF5XSByZXF1aXJlcyBPcGVuU2VhZHJhZ29uJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc3ZnTlMgPSAnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnO1xuXG4gIC8vIC0tLS0tLS0tLS1cbiAgY2xhc3MgT3ZlcmxheSB7XG4gICAgLy8gLS0tLS0tLS0tLVxuXG4gICAgX3ZpZXdlcjogYW55O1xuICAgIF9jb250YWluZXJXaWR0aDogYW55O1xuICAgIF9jb250YWluZXJIZWlnaHQ6IGFueTtcbiAgICBfc3ZnOiBhbnk7XG4gICAgX25vZGU6IGFueTtcblxuICAgIGNvbnN0cnVjdG9yKHZpZXdlcjogYW55KSB7XG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgdGhpcy5fdmlld2VyID0gdmlld2VyO1xuICAgICAgdGhpcy5fY29udGFpbmVyV2lkdGggPSAwO1xuICAgICAgdGhpcy5fY29udGFpbmVySGVpZ2h0ID0gMDtcblxuICAgICAgdGhpcy5fc3ZnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAnc3ZnJyk7XG4gICAgICB0aGlzLl9zdmcuc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgICAgdGhpcy5fc3ZnLnN0eWxlLmxlZnQgPSAwO1xuICAgICAgdGhpcy5fc3ZnLnN0eWxlLnRvcCA9IDA7XG4gICAgICB0aGlzLl9zdmcuc3R5bGUud2lkdGggPSAnMTAwJSc7XG4gICAgICB0aGlzLl9zdmcuc3R5bGUuaGVpZ2h0ID0gJzEwMCUnO1xuICAgICAgdGhpcy5fdmlld2VyLmNhbnZhcy5hcHBlbmRDaGlsZCh0aGlzLl9zdmcpO1xuXG4gICAgICB0aGlzLl9ub2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAnZycpO1xuICAgICAgdGhpcy5fc3ZnLmFwcGVuZENoaWxkKHRoaXMuX25vZGUpO1xuXG4gICAgICB0aGlzLl92aWV3ZXIuYWRkSGFuZGxlcignYW5pbWF0aW9uJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnJlc2l6ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3ZpZXdlci5hZGRIYW5kbGVyKCdvcGVuJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnJlc2l6ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMuX3ZpZXdlci5hZGRIYW5kbGVyKCdyb3RhdGUnLCBmdW5jdGlvbiAoZXZ0OiBhbnkpIHtcbiAgICAgICAgc2VsZi5yZXNpemUoKTtcbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl92aWV3ZXIuYWRkSGFuZGxlcigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnJlc2l6ZSgpO1xuICAgICAgfSk7XG5cbiAgICAgIHRoaXMucmVzaXplKCk7XG4gICAgfVxuICAgIG5vZGUoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fbm9kZTtcbiAgICB9XG5cbiAgICAvLyAtLS0tLS0tLS0tXG4gICAgcmVzaXplKCkge1xuICAgICAgaWYgKHRoaXMuX2NvbnRhaW5lcldpZHRoICE9PSB0aGlzLl92aWV3ZXIuY29udGFpbmVyLmNsaWVudFdpZHRoKSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lcldpZHRoID0gdGhpcy5fdmlld2VyLmNvbnRhaW5lci5jbGllbnRXaWR0aDtcbiAgICAgICAgdGhpcy5fc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB0aGlzLl9jb250YWluZXJXaWR0aCk7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLl9jb250YWluZXJIZWlnaHQgIT09IHRoaXMuX3ZpZXdlci5jb250YWluZXIuY2xpZW50SGVpZ2h0KSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lckhlaWdodCA9IHRoaXMuX3ZpZXdlci5jb250YWluZXIuY2xpZW50SGVpZ2h0O1xuICAgICAgICB0aGlzLl9zdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCB0aGlzLl9jb250YWluZXJIZWlnaHQpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwID0gdGhpcy5fdmlld2VyLnZpZXdwb3J0LnBpeGVsRnJvbVBvaW50KFxuICAgICAgICBuZXcgT3BlblNlYWRyYWdvbi5Qb2ludCgwLCAwKSxcbiAgICAgICAgdHJ1ZSxcbiAgICAgICk7XG4gICAgICBjb25zdCB6b29tID0gdGhpcy5fdmlld2VyLnZpZXdwb3J0LmdldFpvb20odHJ1ZSk7XG4gICAgICBjb25zdCByb3RhdGlvbiA9IHRoaXMuX3ZpZXdlci52aWV3cG9ydC5nZXRSb3RhdGlvbigpO1xuICAgICAgLy8gVE9ETzogRXhwb3NlIGFuIGFjY2Vzc29yIGZvciBfY29udGFpbmVySW5uZXJTaXplIGluIHRoZSBPU0QgQVBJIHNvIHdlIGRvbid0IGhhdmUgdG8gdXNlIHRoZSBwcml2YXRlIHZhcmlhYmxlLlxuICAgICAgY29uc3Qgc2NhbGUgPSB0aGlzLl92aWV3ZXIudmlld3BvcnQuX2NvbnRhaW5lcklubmVyU2l6ZS54ICogem9vbTtcbiAgICAgIHRoaXMuX25vZGUuc2V0QXR0cmlidXRlKFxuICAgICAgICAndHJhbnNmb3JtJyxcbiAgICAgICAgJ3RyYW5zbGF0ZSgnICtcbiAgICAgICAgICBwLnggK1xuICAgICAgICAgICcsJyArXG4gICAgICAgICAgcC55ICtcbiAgICAgICAgICAnKSBzY2FsZSgnICtcbiAgICAgICAgICBzY2FsZSArXG4gICAgICAgICAgJykgcm90YXRlKCcgK1xuICAgICAgICAgIHJvdGF0aW9uICtcbiAgICAgICAgICAnKScsXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIC0tLS0tLS0tLS1cbiAgICBvbkNsaWNrKG5vZGU6IGFueSwgaGFuZGxlcjogYW55KSB7XG4gICAgICAvLyBUT0RPOiBGYXN0IGNsaWNrIGZvciBtb2JpbGUgYnJvd3NlcnNcblxuICAgICAgbmV3IE9wZW5TZWFkcmFnb24uTW91c2VUcmFja2VyKHtcbiAgICAgICAgZWxlbWVudDogbm9kZSxcbiAgICAgICAgY2xpY2tIYW5kbGVyOiBoYW5kbGVyLFxuICAgICAgfSkuc2V0VHJhY2tpbmcodHJ1ZSk7XG4gICAgfVxuICB9XG5cbiAgLy8gLS0tLS0tLS0tLVxuXG4gIC8vIC0tLS0tLS0tLS1cbiAgT3BlblNlYWRyYWdvbi5WaWV3ZXIucHJvdG90eXBlLnN2Z092ZXJsYXkgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKHRoaXMuX3N2Z092ZXJsYXlJbmZvKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc3ZnT3ZlcmxheUluZm87XG4gICAgfVxuXG4gICAgdGhpcy5fc3ZnT3ZlcmxheUluZm8gPSBuZXcgT3ZlcmxheSh0aGlzKTtcbiAgICByZXR1cm4gdGhpcy5fc3ZnT3ZlcmxheUluZm87XG4gIH07XG59XG4iXX0=